<app-header></app-header>
<div class="container" id="main-container">
<div class="ajout">
<h1> TunisAir Users </h1>
<a class="btn btn-success tooltips" style="  color: white; margin-left:10%; height:30px;" (click)="onOpenModal(null,'add')"> <i class="fa fa-plus"></i>  </a>
</div>
<table class="flight-table">
  <thead>
    <tr >
      <th>  ID Utilisateur</th>
      <th>Nom</th>
      <th>Prénom</th>
      <th>Email</th>
      
      <th>Role</th>
      
      <th>Opérations </th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let user of users">
      <td>{{ user.id }}</td>
      <td>{{ user.lname }}</td>
      <td>{{ user.fname }}</td>
      <td>{{ user.email }}</td>
     
      <td>{{ user.role  }}</td>
      
      <td class="float-right btn-group btn-group-sm">
          <a (click)="onOpenModal(user, 'edit')"   class="btn btn-warning tooltips" data-placement="top" data-original-title="Edit"><i class="fa fa-pencil"></i> </a>
          <a (click)="onOpenModal(user, 'delete')" class="btn btn-danger tooltips" data-placement="top" data-original-title="Delete"><i class="fa fa-trash"></i></a>
      
      </td>
    </tr>
  </tbody>
</table>
</div>
<!-- Add User Modal -->
<div class="modal fade" id="addUserModal" tabindex="-1" role="dialog" aria-labelledby="addUserModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
       <div class="modal-header">
          <h5 class="modal-title" id="addUserModalLabel">Add User</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
          </button>
       </div>
       <div class="modal-body">
          <form #addForm="ngForm" (ngSubmit)="onAddUser(addForm)">
            <div class="form-group">
              <label for="name"> Nom </label>
              <input type="text" ngModel name="lname" class="form-control" id="name" placeholder="Nom " required>
           </div>
           <div class="form-group">
              <label for="text">Prénom</label>
              <input type="text" ngModel name="fname" class="form-control" id="email" placeholder="prénom" required>
           </div>
           <div class="form-group">
              <label for="email">Email</label>
              <input type="email" ngModel name="email" class="form-control" id="email" placeholder="xxx@gmail.com" required>
           </div>
           <div class="form-group">
              <label for="pwd">password</label>
              <input type="number" ngModel name="pwd" class="form-control" id="phone" placeholder="*********" required>
           </div>
           <div class="form-group">
              <label for="text">Role </label>
              <input type="text" ngModel name="role" class="form-control" id="imageUrl" placeholder="Simple utilisateur OU Administrateur " required>
           </div>
          
          <div class="modal-footer">
            <button type="button" id="add-User-form" class="btn btn-secondary" data-dismiss="modal">Close</button>
            <button [disabled]="addForm.invalid" type="submit" class="btn btn-primary" >Save changes</button>
         </div>
         </form>
      </div>
   </div>
 </div>
 </div>

<!-- Edit Modal -->
<div class="modal fade" id="updateUserModal" tabindex="-1" role="dialog" aria-labelledby="UserEditModalLabel" aria-hidden="true">
 <div class="modal-dialog" role="document">
    <div class="modal-content">
       <div class="modal-header">
          <h5 class="modal-title" id="updateUserModalLabel">Edit User {{editUser?.fname}}</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
          </button>
       </div>
       <div class="modal-body">
          <form #editForm="ngForm">
            <div class="form-group">
              <label for="name"> Nom </label>
              <input type="text" ngModel="{{editUser?.lname}}" name="lname" class="form-control" id="name" placeholder="nom " required>
           </div>
           <input type="hidden" ngModel="{{editUser?.id}}" name="id" class="form-control" id="id" placeholder="Email">
             

           <div class="form-group">
              <label for="text">Prénom</label>
              <input type="text" ngModel="{{editUser?.fname}}" name="fname" class="form-control" id="email" placeholder="prénom" required>
           </div>
           <div class="form-group">
              <label for="phone">Email</label>
              <input type="text" ngModel="{{editUser?.email}}" name="email" class="form-control" id="jobTile" placeholder="xxx@gmail.com" required>
           </div>
           <div class="form-group">
              <label for="text">password</label>
              <input type="text" ngModel="{{editUser?.password}}" name="pwd" class="form-control" id="phone" placeholder="*******" required>
           </div>
           <div class="form-group">
              <label for="phone">Role</label>
              <input type="text" ngModel="{{editUser?.role}}" name="role" class="form-control" id="imageUrl" placeholder="Utilisateur OU Administrateur " required>
           </div>
              <div class="modal-footer">
                 <button type="button" id="" data-dismiss="modal" class="btn btn-secondary">Close</button>
                 <button   *ngIf="editUser" (click)="onUpdateUser(editUser.id,editForm.value)" data-dismiss="modal" class="btn btn-primary" >Save changes</button>
              </div>
           </form>
        </div>
     </div>
  </div>
</div>
<!-- Delete Modal -->
<div class="modal fade" id="deleteUserModal" tabindex="-1" role="dialog" aria-labelledby="deleteModelLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
     <div class="modal-content">
        <div class="modal-header">
           <h5 class="modal-title" id="deleteModelLabel">Delete User</h5>
           <button type="button" class="close" data-dismiss="modal" aria-label="Close">
           <span aria-hidden="true">&times;</span>
           </button>
        </div>
        <div class="modal-body">
           <p>Êtes-vous sûr de vouloir supprimer l'utilisateur  {{deleteUser?.fname}} {{deleteUser?.lname}} ?</p>
           <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Non</button>
              <button *ngIf="deleteUser" (click)="onDeleteUser(deleteUser.id)" class="btn btn-danger" data-dismiss="modal">Oui</button>
           </div>
        </div>
     </div>
  </div>


